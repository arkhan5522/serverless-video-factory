name: Transfer Secrets
on: workflow_dispatch

jobs:
  transfer-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Transfer Secrets
        env:
          # --- CONFIGURATION ---
          # Token hardcoded as requested.
          GH_TOKEN: "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"
          TARGET_REPO: "arkhan5522/serverless-videoo-factory-spanish"

          # --- SECRETS TO TRANSFER ---
          ASSEMBLYAI_API_KEY: ${{ secrets.ASSEMBLYAI_API_KEY }}
          FREEPIK_API_KEY: ${{ secrets.FREEPIK_API_KEY }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          GOOGLE_DRIVE_CREDENTIALS: ${{ secrets.GOOGLE_DRIVE_CREDENTIALS }}
          GOOGLE_DRIVE_FOLDER_ID: ${{ secrets.GOOGLE_DRIVE_FOLDER_ID }}
          KAGGLE_KEY: ${{ secrets.KAGGLE_KEY }}
          KAGGLE_USERNAME: ${{ secrets.KAGGLE_USERNAME }}
          OAUTH_CLIENT_ID: ${{ secrets.OAUTH_CLIENT_ID }}
          OAUTH_CLIENT_SECRET: ${{ secrets.OAUTH_CLIENT_SECRET }}
          OAUTH_REFRESH_TOKEN: ${{ secrets.OAUTH_REFRESH_TOKEN }}
          PERSONAL_ACCESS_TOKEN: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
          PEXELS_KEYS: ${{ secrets.PEXELS_KEYS }}
          PIXABAY_KEYS: ${{ secrets.PIXABAY_KEYS }}

        run: |
          # Loop through environment variables and upload them to the new repo
          for key in $(env | cut -d= -f1); do
            # Filter out the script config and default system variables
            if [[ "$key" != "GH_TOKEN" && "$key" != "TARGET_REPO" && "$key" != "HOME" && "$key" != "GITHUB_"* && "$key" != "RUNNER_"* ]]; then
              echo "Processing secret: $key"
              
              # Read the value of the variable securely
              val="${!key}"
              
              # Upload to the target repo using GitHub CLI
              gh secret set "$key" --body "$val" --repo "$TARGET_REPO"
            fi
          done
